!function(i,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-color")):"function"==typeof define&&define.amd?define(["exports","d3-color"],t):t((i=i||self).d3=i.d3||{},i.d3)}(this,function(i,n){"use strict";function r(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function e(i,t){for(var n=0;n<t.length;n++){var e=t[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(i,e.key,e)}}function a(i,t,n){return t&&e(i.prototype,t),n&&e(i,n),i}var o=function(){function t(i){r(this,t),this.config=i}return a(t,[{key:"draw",value:function(i,t){this.element=i,this.diagramConfig=t,this.shape=[1,-1],this.config.shape&&(this.shape=this.config.shape),-1===this.shape[0]&&(this.shape[0]=this.diagramConfig.numColumns),-1===this.shape[1]&&(this.shape[1]=this.diagramConfig.numRows),this.annotation=this.element.append("rect"),this.annotation.attr("x",0).attr("y",0).attr("rx",2).attr("ry",2).attr("width",this.diagramConfig.cellSize*this.shape[0]).attr("height",this.diagramConfig.paddedCellSize*this.shape[1]).style("fill",n.rgb(this.config.color)).style("opacity",.5)}},{key:"update",value:function(i,t,n,e,a){-1===n&&(n=this.shape[0]),-1===e&&(e=this.shape[1]),this.annotation.transition().attr("x",this.diagramConfig.paddedCellSize*i).attr("y",this.diagramConfig.paddedCellSize*t).attr("width",this.diagramConfig.paddedCellSize*n).attr("height",this.diagramConfig.paddedCellSize*e).duration(a)}}]),t}(),s=function(){function h(i,t,n,e){r(this,h),this.element=i,this.config=e,null==this.config&&(this.config={}),this.config.numColumns=n,this.config.numRows=t,this.config.cellSize=20,this.config.cellPadding=1,this.config.paddedCellSize=this.config.cellSize+2*this.config.cellPadding,this.config.width=this.config.numColumns*this.config.paddedCellSize,this.config.height=this.config.numRows*this.config.paddedCellSize;var a=this.element.append("svg").attr("width",this.config.paddedCellSize*this.config.numColumns).attr("height",this.config.paddedCellSize*this.config.numRows).attr("class","d3-hinton");this.container=a.append("g"),this.container.append("rect").attr("class","d3-hinton-background").attr("x",0).attr("y",0).attr("rx",2).attr("ry",2).attr("width",this.config.paddedCellSize*this.config.numColumns).attr("height",this.config.paddedCellSize*this.config.numRows),"show_grid"in this.config&&this.drawGridLines(this.container),this.annotationContainer=this.container.append("g"),this.cells=[];for(var o=0;o<this.config.numRows;o++){this.cells[o]=[];for(var s=0;s<this.config.numColumns;s++)this.cells[o][s]=this.container.append("rect").attr("class","d3-hinton-cell").attr("x",s*this.config.paddedCellSize+this.config.cellPadding).attr("y",o*this.config.paddedCellSize+this.config.cellPadding).attr("width",.5*this.config.cellSize).attr("height",.5*this.config.cellSize)}}return a(h,[{key:"drawGridLines",value:function(i){for(var t=0+this.config.paddedCellSize*(this.config.numColumns-0),n=0+this.config.paddedCellSize*(this.config.numRows-0),e=0;e<this.config.numColumns;e++){var a=this.config.paddedCellSize/2+e*this.config.paddedCellSize-.5;i.append("line").attr("class","d3-hinton-gridline").attr("x1",a).attr("y1",0).attr("x2",a).attr("y2",n)}for(var o=0;o<this.config.numRows;o++){var s=this.config.paddedCellSize/2+o*this.config.paddedCellSize-.5;i.append("line").attr("class","d3-hinton-gridline").attr("x1",0).attr("y1",s).attr("x2",t).attr("y2",s)}}},{key:"annotation",value:function(i){var t=new o(i);return t.draw(this.annotationContainer,this.config),t}},{key:"eachCell",value:function(i){for(var t=0;t<this.config.numColumns;t++)for(var n=this.columns[t],e=0;e<this.config.numRows;e++)i(t,e,n[e])}},{key:"update",value:function(i,t){for(var n=0;n<this.config.numColumns;n++)for(var e=0;e<this.config.numRows;e++){var a=this.cells[e][n],o=i[e][n];this.config.transpose&&(o=i[n][e]),a.classed("negative",o<0);var s=Math.min(1,Math.abs(o)),h=.8*this.config.cellSize*Math.sqrt(s);h||(h=0);var r=(this.config.cellSize-h)/2,d=n*this.config.paddedCellSize+this.config.cellPadding,l=e*this.config.paddedCellSize+this.config.cellPadding;a.transition().attr("x",d+r).attr("y",l+r).attr("width",h).attr("height",h).duration(t)}}}]),h}();i.hinton=function(i,t,n,e){return new s(i,t,n,e)},Object.defineProperty(i,"__esModule",{value:!0})});